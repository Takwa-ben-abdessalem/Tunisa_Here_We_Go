import { Injectable, Inject } from '@angular/core';
import { filter, map } from 'rxjs/operators';
import { STRIPE_PUBLISHABLE_KEY, STRIPE_OPTIONS, NGX_STRIPE_VERSION } from '../interfaces/ngx-stripe.interface';
import { StripeInstance } from './stripe-instance.class';
import * as i0 from "@angular/core";
import * as i1 from "./api-loader.service";
import * as i2 from "./window-ref.service";
export class StripeService {
    constructor(version, key, options, loader, window) {
        this.version = version;
        this.key = key;
        this.options = options;
        this.loader = loader;
        this.window = window;
        if (key) {
            this.stripe = new StripeInstance(this.version, this.loader, this.window, key, options);
        }
    }
    getStripeReference() {
        return this.loader.asStream().pipe(filter((status) => status.loaded === true), map(() => this.window.getNativeWindow().Stripe));
    }
    getInstance() {
        return this.stripe.getInstance();
    }
    setKey(key, options) {
        return this.changeKey(key, options);
    }
    changeKey(key, options) {
        this.stripe = new StripeInstance(this.version, this.loader, this.window, key, options);
        return this.stripe;
    }
    elements(options) {
        return this.stripe.elements(options);
    }
    redirectToCheckout(options) {
        return this.stripe.redirectToCheckout(options);
    }
    confirmPayment(options) {
        return this.stripe.confirmPayment(options);
    }
    confirmAcssDebitPayment(clientSecret, data, options) {
        return this.stripe.confirmAcssDebitPayment(clientSecret, data, options);
    }
    confirmUsBankAccountPayment(clientSecret, data) {
        return this.stripe.confirmUsBankAccountPayment(clientSecret, data);
    }
    confirmAlipayPayment(clientSecret, data, options) {
        return this.stripe.confirmAlipayPayment(clientSecret, data, options);
    }
    confirmAuBecsDebitPayment(clientSecret, data) {
        return this.stripe.confirmAuBecsDebitPayment(clientSecret, data);
    }
    confirmBancontactPayment(clientSecret, data, options) {
        return this.stripe.confirmBancontactPayment(clientSecret, data, options);
    }
    confirmBoletoPayment(clientSecret, data, options) {
        return this.stripe.confirmBoletoPayment(clientSecret, data, options);
    }
    confirmCardPayment(clientSecret, data, options) {
        return this.stripe.confirmCardPayment(clientSecret, data, options);
    }
    confirmCustomerBalancePayment(clientSecret, data, options) {
        return this.stripe.confirmCustomerBalancePayment(clientSecret, data, options);
    }
    confirmEpsPayment(clientSecret, data, options) {
        return this.stripe.confirmEpsPayment(clientSecret, data, options);
    }
    confirmFpxPayment(clientSecret, data, options) {
        return this.stripe.confirmFpxPayment(clientSecret, data, options);
    }
    confirmGiropayPayment(clientSecret, data, options) {
        return this.stripe.confirmGiropayPayment(clientSecret, data, options);
    }
    confirmGrabPayPayment(clientSecret, data, options) {
        return this.stripe.confirmGrabPayPayment(clientSecret, data, options);
    }
    confirmIdealPayment(clientSecret, data, options) {
        return this.stripe.confirmIdealPayment(clientSecret, data, options);
    }
    confirmKlarnaPayment(clientSecret, data, options) {
        return this.stripe.confirmKlarnaPayment(clientSecret, data, options);
    }
    confirmKonbiniPayment(clientSecret, data, options) {
        return this.stripe.confirmKonbiniPayment(clientSecret, data, options);
    }
    confirmOxxoPayment(clientSecret, data, options) {
        return this.stripe.confirmOxxoPayment(clientSecret, data, options);
    }
    confirmP24Payment(clientSecret, data, options) {
        return this.stripe.confirmP24Payment(clientSecret, data, options);
    }
    confirmPayNowPayment(clientSecret, data, options) {
        return this.stripe.confirmPayNowPayment(clientSecret, data, options);
    }
    confirmPayPalPayment(clientSecret, data) {
        return this.stripe.confirmPayPalPayment(clientSecret, data);
    }
    confirmPromptPayPayment(clientSecret, data, options) {
        return this.stripe.confirmPromptPayPayment(clientSecret, data, options);
    }
    confirmSepaDebitPayment(clientSecret, data) {
        return this.stripe.confirmSepaDebitPayment(clientSecret, data);
    }
    confirmSofortPayment(clientSecret, data, options) {
        return this.stripe.confirmSofortPayment(clientSecret, data, options);
    }
    confirmWechatPayPayment(clientSecret, data, options) {
        return this.stripe.confirmWechatPayPayment(clientSecret, data, options);
    }
    handleCardAction(clientSecret) {
        return this.stripe.handleCardAction(clientSecret);
    }
    verifyMicrodepositsForPayment(clientSecret, data) {
        return this.stripe.verifyMicrodepositsForPayment(clientSecret, data);
    }
    collectBankAccountForPayment(options) {
        return this.stripe.collectBankAccountForPayment(options);
    }
    createPaymentMethod(paymentMethodData) {
        return this.stripe.createPaymentMethod(paymentMethodData);
    }
    retrievePaymentIntent(clientSecret) {
        return this.stripe.retrievePaymentIntent(clientSecret);
    }
    confirmSetup(options) {
        return this.stripe.confirmSetup(options);
    }
    confirmAcssDebitSetup(clientSecret, data, options) {
        return this.stripe.confirmAcssDebitSetup(clientSecret, data, options);
    }
    confirmUsBankAccountSetup(clientSecret, data) {
        return this.stripe.confirmUsBankAccountSetup(clientSecret, data);
    }
    confirmAuBecsDebitSetup(clientSecret, data) {
        return this.stripe.confirmAuBecsDebitSetup(clientSecret, data);
    }
    confirmBacsDebitSetup(clientSecret, data) {
        return this.stripe.confirmBacsDebitSetup(clientSecret, data);
    }
    confirmBancontactSetup(clientSecret, data) {
        return this.stripe.confirmBancontactSetup(clientSecret, data);
    }
    confirmCardSetup(clientSecret, data, options) {
        return this.stripe.confirmCardSetup(clientSecret, data, options);
    }
    confirmIdealSetup(clientSecret, data) {
        return this.stripe.confirmIdealSetup(clientSecret, data);
    }
    confirmPayPalSetup(clientSecret, data) {
        return this.stripe.confirmPayPalSetup(clientSecret, data);
    }
    confirmSepaDebitSetup(clientSecret, data) {
        return this.stripe.confirmSepaDebitSetup(clientSecret, data);
    }
    confirmSofortSetup(clientSecret, data, options) {
        return this.stripe.confirmSofortSetup(clientSecret, data, options);
    }
    confirmAffirmPayment(clientSecret, data, options) {
        return this.stripe.confirmAffirmPayment(clientSecret, data, options);
    }
    confirmAfterpayClearpayPayment(clientSecret, data, options) {
        return this.stripe.confirmAfterpayClearpayPayment(clientSecret, data, options);
    }
    verifyMicrodepositsForSetup(clientSecret, data) {
        return this.stripe.verifyMicrodepositsForSetup(clientSecret, data);
    }
    collectBankAccountForSetup(options) {
        return this.stripe.collectBankAccountForSetup(options);
    }
    retrieveSetupIntent(clientSecret) {
        return this.stripe.retrieveSetupIntent(clientSecret);
    }
    paymentRequest(options) {
        return this.stripe.paymentRequest(options);
    }
    createToken(tokenType, data) {
        return this.stripe.createToken(tokenType, data);
    }
    createSource(a, b) {
        return this.stripe.createSource(a, b);
    }
    retrieveSource(source) {
        return this.stripe.retrieveSource(source);
    }
    verifyIdentity(clientSecret) {
        return this.stripe.verifyIdentity(clientSecret);
    }
    /**
     * @deprecated
     */
    handleCardPayment(clientSecret, element, data) {
        return this.stripe.handleCardPayment(clientSecret, element, data);
    }
    /**
     * @deprecated
     */
    confirmPaymentIntent(clientSecret, element, data) {
        return this.stripe.confirmPaymentIntent(clientSecret, element, data);
    }
    /**
     * @deprecated
     */
    handleCardSetup(clientSecret, element, data) {
        return this.stripe.handleCardSetup(clientSecret, element, data);
    }
    /**
     * @deprecated
     */
    confirmSetupIntent(clientSecret, element, data) {
        return this.stripe.confirmSetupIntent(clientSecret, element, data);
    }
    /**
     * @deprecated
     */
    handleFpxPayment(clientSecret, element, data) {
        return this.stripe.handleFpxPayment(clientSecret, element, data);
    }
}
StripeService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.8", ngImport: i0, type: StripeService, deps: [{ token: NGX_STRIPE_VERSION }, { token: STRIPE_PUBLISHABLE_KEY }, { token: STRIPE_OPTIONS }, { token: i1.LazyStripeAPILoader }, { token: i2.WindowRef }], target: i0.ɵɵFactoryTarget.Injectable });
StripeService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "13.3.8", ngImport: i0, type: StripeService });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.8", ngImport: i0, type: StripeService, decorators: [{
            type: Injectable
        }], ctorParameters: function () { return [{ type: undefined, decorators: [{
                    type: Inject,
                    args: [NGX_STRIPE_VERSION]
                }] }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [STRIPE_PUBLISHABLE_KEY]
                }] }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [STRIPE_OPTIONS]
                }] }, { type: i1.LazyStripeAPILoader }, { type: i2.WindowRef }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RyaXBlLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtc3RyaXBlL3NyYy9saWIvc2VydmljZXMvc3RyaXBlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFbkQsT0FBTyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQWdHN0MsT0FBTyxFQUFFLHNCQUFzQixFQUFFLGNBQWMsRUFBRSxrQkFBa0IsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBTWhILE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQzs7OztBQUd6RCxNQUFNLE9BQU8sYUFBYTtJQUd4QixZQUNxQyxPQUFlLEVBQ1gsR0FBVyxFQUNuQixPQUFpQyxFQUN6RCxNQUEyQixFQUMzQixNQUFpQjtRQUpXLFlBQU8sR0FBUCxPQUFPLENBQVE7UUFDWCxRQUFHLEdBQUgsR0FBRyxDQUFRO1FBQ25CLFlBQU8sR0FBUCxPQUFPLENBQTBCO1FBQ3pELFdBQU0sR0FBTixNQUFNLENBQXFCO1FBQzNCLFdBQU0sR0FBTixNQUFNLENBQVc7UUFFeEIsSUFBSSxHQUFHLEVBQUU7WUFDUCxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksY0FBYyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUN4RjtJQUNILENBQUM7SUFFRCxrQkFBa0I7UUFDaEIsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLElBQUksQ0FDaEMsTUFBTSxDQUFDLENBQUMsTUFBaUMsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sS0FBSyxJQUFJLENBQUMsRUFDckUsR0FB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Q0gsZ0JBQWdCLENBQ2QsWUFBb0IsRUFDcEIsT0FBUSxFQUNSLElBQUs7UUFLTCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNuRSxDQUFDOzswR0FybkJVLGFBQWEsa0JBSWQsa0JBQWtCLGFBQ2xCLHNCQUFzQixhQUN0QixjQUFjOzhHQU5iLGFBQWE7MkZBQWIsYUFBYTtrQkFEekIsVUFBVTs7MEJBS04sTUFBTTsyQkFBQyxrQkFBa0I7OzBCQUN6QixNQUFNOzJCQUFDLHNCQUFzQjs7MEJBQzdCLE1BQU07MkJBQUMsY0FBYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIEluamVjdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyLCBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7XG4gIENvbmZpcm1BY3NzRGViaXRQYXltZW50RGF0YSxcbiAgQ29uZmlybUFjc3NEZWJpdFBheW1lbnRPcHRpb25zLFxuICBDb25maXJtQWZ0ZXJwYXlDbGVhcnBheVBheW1lbnREYXRhLFxuICBDb25maXJtQWZ0ZXJwYXlDbGVhcnBheVBheW1lbnRPcHRpb25zLFxuICBDb25maXJtQWxpcGF5UGF5bWVudERhdGEsXG4gIENvbmZpcm1BbGlwYXlQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybUF1QmVjc0RlYml0UGF5bWVudERhdGEsXG4gIENvbmZpcm1BdUJlY3NEZWJpdFNldHVwRGF0YSxcbiAgQ29uZmlybUJhbmNvbnRhY3RQYXltZW50RGF0YSxcbiAgQ29uZmlybUJhbmNvbnRhY3RQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybUJvbGV0b1BheW1lbnREYXRhLFxuICBDb25maXJtQm9sZXRvUGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1DYXJkUGF5bWVudERhdGEsXG4gIENvbmZpcm1DYXJkUGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1FcHNQYXltZW50RGF0YSxcbiAgQ29uZmlybUVwc1BheW1lbnRPcHRpb25zLFxuICBDb25maXJtRnB4UGF5bWVudERhdGEsXG4gIENvbmZpcm1GcHhQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybUdpcm9wYXlQYXltZW50RGF0YSxcbiAgQ29uZmlybUdpcm9wYXlQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybUdyYWJQYXlQYXltZW50RGF0YSxcbiAgQ29uZmlybUdyYWJQYXlQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybUlkZWFsUGF5bWVudERhdGEsXG4gIENvbmZpcm1JZGVhbFBheW1lbnRPcHRpb25zLFxuICBDb25maXJtS2xhcm5hUGF5bWVudERhdGEsXG4gIENvbmZpcm1LbGFybmFQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybU94eG9QYXltZW50RGF0YSxcbiAgQ29uZmlybU94eG9QYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybVAyNFBheW1lbnREYXRhLFxuICBDb25maXJtUDI0UGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1DYXJkU2V0dXBEYXRhLFxuICBDb25maXJtQ2FyZFNldHVwT3B0aW9ucyxcbiAgQ29uZmlybVNlcGFEZWJpdFBheW1lbnREYXRhLFxuICBDb25maXJtU29mb3J0UGF5bWVudERhdGEsXG4gIENvbmZpcm1XZWNoYXRQYXlQYXltZW50RGF0YSxcbiAgQ29uZmlybVdlY2hhdFBheVBheW1lbnRPcHRpb25zLFxuICBDb25maXJtU2VwYURlYml0U2V0dXBEYXRhLFxuICBDcmVhdGVQYXltZW50TWV0aG9kRGF0YSxcbiAgVmVyaWZ5TWljcm9kZXBvc2l0c0ZvclBheW1lbnREYXRhLFxuICBDb25maXJtQWNzc0RlYml0U2V0dXBEYXRhLFxuICBDb25maXJtQWNzc0RlYml0U2V0dXBPcHRpb25zLFxuICBDcmVhdGVTb3VyY2VEYXRhLFxuICBDcmVhdGVUb2tlbkliYW5EYXRhLFxuICBDcmVhdGVUb2tlbkNhcmREYXRhLFxuICBDcmVhdGVUb2tlblBpaURhdGEsXG4gIENyZWF0ZVRva2VuQmFua0FjY291bnREYXRhLFxuICBQYXltZW50SW50ZW50LFxuICBQYXltZW50TWV0aG9kLFxuICBQYXltZW50UmVxdWVzdCxcbiAgUGF5bWVudFJlcXVlc3RPcHRpb25zLFxuICBSZWRpcmVjdFRvQ2hlY2tvdXRPcHRpb25zLFxuICBSZXRyaWV2ZVNvdXJjZVBhcmFtLFxuICBTZXR1cEludGVudCxcbiAgU3RyaXBlLFxuICBTdHJpcGVDYXJkRWxlbWVudCxcbiAgU3RyaXBlQ2FyZE51bWJlckVsZW1lbnQsXG4gIFN0cmlwZUNhcmRDdmNFbGVtZW50LFxuICBTdHJpcGVDb25zdHJ1Y3Rvck9wdGlvbnMsXG4gIFN0cmlwZUVsZW1lbnRzLFxuICBTdHJpcGVFbGVtZW50c09wdGlvbnMsXG4gIFN0cmlwZUVsZW1lbnQsXG4gIFN0cmlwZUVycm9yLFxuICBTdHJpcGVJYmFuRWxlbWVudCxcbiAgU291cmNlLFxuICBUb2tlbixcbiAgVG9rZW5DcmVhdGVQYXJhbXMsXG4gIENvbmZpcm1CYWNzRGViaXRTZXR1cERhdGEsXG4gIENvbmZpcm1CYW5jb250YWN0U2V0dXBEYXRhLFxuICBDb25maXJtSWRlYWxTZXR1cERhdGEsXG4gIENvbmZpcm1Tb2ZvcnRTZXR1cERhdGEsXG4gIFZlcmlmeU1pY3JvZGVwb3NpdHNGb3JTZXR1cERhdGEsXG4gIFZlcmlmaWNhdGlvblNlc3Npb25SZXN1bHQsXG4gIENvbmZpcm1QYXlQYWxQYXltZW50RGF0YSxcbiAgQ29uZmlybVBheVBhbFNldHVwRGF0YSxcbiAgQ29uZmlybVBheW1lbnREYXRhLFxuICBDb25maXJtQ3VzdG9tZXJCYWxhbmNlUGF5bWVudERhdGEsXG4gIENvbmZpcm1DdXN0b21lckJhbGFuY2VQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybVBheU5vd1BheW1lbnREYXRhLFxuICBDb25maXJtUGF5Tm93UGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1Qcm9tcHRQYXlQYXltZW50RGF0YSxcbiAgQ29uZmlybVByb21wdFBheVBheW1lbnRPcHRpb25zLFxuICBDb25maXJtQWZmaXJtUGF5bWVudERhdGEsXG4gIENvbmZpcm1BZmZpcm1QYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybVNvZm9ydFBheW1lbnRPcHRpb25zLFxuICBDb25maXJtU29mb3J0U2V0dXBPcHRpb25zLFxuICBDb25maXJtS29uYmluaVBheW1lbnREYXRhLFxuICBDb25maXJtS29uYmluaVBheW1lbnRPcHRpb25zLFxuICBDb25maXJtVXNCYW5rQWNjb3VudFBheW1lbnREYXRhLFxuICBDb2xsZWN0QmFua0FjY291bnRGb3JQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybVVzQmFua0FjY291bnRTZXR1cERhdGEsXG4gIENvbGxlY3RCYW5rQWNjb3VudEZvclNldHVwT3B0aW9uc1xufSBmcm9tICdAc3RyaXBlL3N0cmlwZS1qcyc7XG5cbmltcG9ydCB7IFNUUklQRV9QVUJMSVNIQUJMRV9LRVksIFNUUklQRV9PUFRJT05TLCBOR1hfU1RSSVBFX1ZFUlNJT04gfSBmcm9tICcuLi9pbnRlcmZhY2VzL25neC1zdHJpcGUuaW50ZXJmYWNlJztcbmltcG9ydCB7IFN0cmlwZVNlcnZpY2VJbnRlcmZhY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3N0cmlwZS1pbnN0YW5jZS5pbnRlcmZhY2UnO1xuXG5pbXBvcnQgeyBXaW5kb3dSZWYgfSBmcm9tICcuL3dpbmRvdy1yZWYuc2VydmljZSc7XG5pbXBvcnQgeyBMYXp5U3RyaXBlQVBJTG9hZGVyLCBMYXp5U3RyaXBlQVBJTG9hZGVyU3RhdHVzIH0gZnJvbSAnLi9hcGktbG9hZGVyLnNlcnZpY2UnO1xuXG5pbXBvcnQgeyBTdHJpcGVJbnN0YW5jZSB9IGZyb20gJy4vc3RyaXBlLWluc3RhbmNlLmNsYXNzJztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFN0cmlwZVNlcnZpY2UgaW1wbGVtZW50cyBTdHJpcGVTZXJ2aWNlSW50ZXJmYWNlIHtcbiAgc3RyaXBlITogU3RyaXBlSW5zdGFuY2U7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgQEluamVjdChOR1hfU1RSSVBFX1ZFUlNJT04pIHB1YmxpYyB2ZXJzaW9uOiBzdHJpbmcsXG4gICAgQEluamVjdChTVFJJUEVfUFVCTElTSEFCTEVfS0VZKSBwdWJsaWMga2V5OiBzdHJpbmcsXG4gICAgQEluamVjdChTVFJJUEVfT1BUSU9OUykgcHVibGljIG9wdGlvbnM6IFN0cmlwZUNvbnN0cnVjdG9yT3B0aW9ucyxcbiAgICBwdWJsaWMgbG9hZGVyOiBMYXp5U3RyaXBlQVBJTG9hZGVyLFxuICAgIHB1YmxpYyB3aW5kb3c6IFdpbmRvd1JlZlxuICApIHtcbiAgICBpZiAoa2V5KSB7XG4gICAgICB0aGlzLnN0cmlwZSA9IG5ldyBTdHJpcGVJbnN0YW5jZSh0aGlzLnZlcnNpb24sIHRoaXMubG9hZGVyLCB0aGlzLndpbmRvdywga2V5LCBvcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICBnZXRTdHJpcGVSZWZlcmVuY2UoKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy5sb2FkZXIuYXNTdHJlYW0oKS5waXBlKFxuICAgICAgZmlsdGVyKChzdGF0dXM6IExhenlTdHJpcGVBUElMb2FkZXJTdGF0dXMpID0+IHN0YXR1cy5sb2FkZWQgPT09IHRydWUpLFxuICAgICAgbWFwKCgpID0+ICh0aGlzLndpbmRvdy5nZXROYXRpdmVXaW5kb3coKSBhcyBhbnkpLlN0cmlwZSlcbiAgICApO1xuICB9XG5cbiAgZ2V0SW5zdGFuY2UoKTogU3RyaXBlIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuZ2V0SW5zdGFuY2UoKTtcbiAgfVxuXG4gIHNldEtleShrZXk6IHN0cmluZywgb3B0aW9ucz86IFN0cmlwZUNvbnN0cnVjdG9yT3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLmNoYW5nZUtleShrZXksIG9wdGlvbnMpO1xuICB9XG5cbiAgY2hhbmdlS2V5KGtleTogc3RyaW5nLCBvcHRpb25zPzogU3RyaXBlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgdGhpcy5zdHJpcGUgPSBuZXcgU3RyaXBlSW5zdGFuY2UodGhpcy52ZXJzaW9uLCB0aGlzLmxvYWRlciwgdGhpcy53aW5kb3csIGtleSwgb3B0aW9ucyk7XG5cbiAgICByZXR1cm4gdGhpcy5zdHJpcGU7XG4gIH1cblxuICBlbGVtZW50cyhvcHRpb25zPzogU3RyaXBlRWxlbWVudHNPcHRpb25zKTogT2JzZXJ2YWJsZTxTdHJpcGVFbGVtZW50cz4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5lbGVtZW50cyhvcHRpb25zKTtcbiAgfVxuXG4gIHJlZGlyZWN0VG9DaGVja291dChvcHRpb25zPzogUmVkaXJlY3RUb0NoZWNrb3V0T3B0aW9ucyk6IE9ic2VydmFibGU8bmV2ZXIgfCB7IGVycm9yOiBTdHJpcGVFcnJvciB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLnJlZGlyZWN0VG9DaGVja291dChvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1QYXltZW50KG9wdGlvbnM6IHtcbiAgICBlbGVtZW50czogU3RyaXBlRWxlbWVudHM7XG4gICAgY29uZmlybVBhcmFtcz86IFBhcnRpYWw8Q29uZmlybVBheW1lbnREYXRhPjtcbiAgICByZWRpcmVjdDogJ2lmX3JlcXVpcmVkJztcbiAgfSk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+O1xuICBjb25maXJtUGF5bWVudChvcHRpb25zOiB7XG4gICAgZWxlbWVudHM6IFN0cmlwZUVsZW1lbnRzO1xuICAgIGNvbmZpcm1QYXJhbXM6IENvbmZpcm1QYXltZW50RGF0YTtcbiAgICByZWRpcmVjdD86ICdhbHdheXMnO1xuICB9KTogT2JzZXJ2YWJsZTxuZXZlciB8IHsgZXJyb3I6IFN0cmlwZUVycm9yIH0+O1xuICBjb25maXJtUGF5bWVudChvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1QYXltZW50KG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUFjc3NEZWJpdFBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1BY3NzRGViaXRQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUFjc3NEZWJpdFBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUFjc3NEZWJpdFBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1Vc0JhbmtBY2NvdW50UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybVVzQmFua0FjY291bnRQYXltZW50RGF0YVxuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1Vc0JhbmtBY2NvdW50UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybUFsaXBheVBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1BbGlwYXlQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUFsaXBheVBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUFsaXBheVBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1BdUJlY3NEZWJpdFBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1BdUJlY3NEZWJpdFBheW1lbnREYXRhXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUF1QmVjc0RlYml0UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybUJhbmNvbnRhY3RQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtQmFuY29udGFjdFBheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtQmFuY29udGFjdFBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUJhbmNvbnRhY3RQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtQm9sZXRvUGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUJvbGV0b1BheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtQm9sZXRvUGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtQm9sZXRvUGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUNhcmRQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtQ2FyZFBheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtQ2FyZFBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUNhcmRQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtQ3VzdG9tZXJCYWxhbmNlUGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUN1c3RvbWVyQmFsYW5jZVBheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtQ3VzdG9tZXJCYWxhbmNlUGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtQ3VzdG9tZXJCYWxhbmNlUGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUVwc1BheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1FcHNQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUVwc1BheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUVwc1BheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1GcHhQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtRnB4UGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1GcHhQYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1GcHhQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtR2lyb3BheVBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1HaXJvcGF5UGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1HaXJvcGF5UGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtR2lyb3BheVBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1HcmFiUGF5UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUdyYWJQYXlQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUdyYWJQYXlQYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1HcmFiUGF5UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUlkZWFsUGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUlkZWFsUGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1JZGVhbFBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUlkZWFsUGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUtsYXJuYVBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1LbGFybmFQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUtsYXJuYVBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUtsYXJuYVBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1Lb25iaW5pUGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUtvbmJpbmlQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUtvbmJpbmlQYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1Lb25iaW5pUGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybU94eG9QYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtT3h4b1BheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtT3h4b1BheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybU94eG9QYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtUDI0UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybVAyNFBheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtUDI0UGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtUDI0UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybVBheU5vd1BheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1QYXlOb3dQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybVBheU5vd1BheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybVBheU5vd1BheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1QYXlQYWxQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtUGF5UGFsUGF5bWVudERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtUGF5UGFsUGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybVByb21wdFBheVBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1Qcm9tcHRQYXlQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybVByb21wdFBheVBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybVByb21wdFBheVBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1TZXBhRGViaXRQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtU2VwYURlYml0UGF5bWVudERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtU2VwYURlYml0UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybVNvZm9ydFBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1Tb2ZvcnRQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybVNvZm9ydFBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybVNvZm9ydFBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1XZWNoYXRQYXlQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtV2VjaGF0UGF5UGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1XZWNoYXRQYXlQYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1XZWNoYXRQYXlQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBoYW5kbGVDYXJkQWN0aW9uKGNsaWVudFNlY3JldDogc3RyaW5nKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5oYW5kbGVDYXJkQWN0aW9uKGNsaWVudFNlY3JldCk7XG4gIH1cblxuICB2ZXJpZnlNaWNyb2RlcG9zaXRzRm9yUGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogVmVyaWZ5TWljcm9kZXBvc2l0c0ZvclBheW1lbnREYXRhXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUudmVyaWZ5TWljcm9kZXBvc2l0c0ZvclBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhKTtcbiAgfVxuXG4gIGNvbGxlY3RCYW5rQWNjb3VudEZvclBheW1lbnQob3B0aW9uczogQ29sbGVjdEJhbmtBY2NvdW50Rm9yUGF5bWVudE9wdGlvbnMpOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbGxlY3RCYW5rQWNjb3VudEZvclBheW1lbnQob3B0aW9ucyk7XG4gIH1cblxuICBjcmVhdGVQYXltZW50TWV0aG9kKHBheW1lbnRNZXRob2REYXRhOiBDcmVhdGVQYXltZW50TWV0aG9kRGF0YSk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRNZXRob2Q/OiBQYXltZW50TWV0aG9kO1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY3JlYXRlUGF5bWVudE1ldGhvZChwYXltZW50TWV0aG9kRGF0YSk7XG4gIH1cblxuICByZXRyaWV2ZVBheW1lbnRJbnRlbnQoY2xpZW50U2VjcmV0OiBzdHJpbmcpOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLnJldHJpZXZlUGF5bWVudEludGVudChjbGllbnRTZWNyZXQpO1xuICB9XG5cbiAgY29uZmlybVNldHVwKG9wdGlvbnM6IHtcbiAgICBlbGVtZW50czogU3RyaXBlRWxlbWVudHM7XG4gICAgY29uZmlybVBhcmFtcz86IFBhcnRpYWw8Q29uZmlybVBheW1lbnREYXRhPjtcbiAgICByZWRpcmVjdDogJ2lmX3JlcXVpcmVkJztcbiAgfSk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT47XG4gIGNvbmZpcm1TZXR1cChvcHRpb25zOiB7XG4gICAgZWxlbWVudHM6IFN0cmlwZUVsZW1lbnRzO1xuICAgIGNvbmZpcm1QYXJhbXM6IENvbmZpcm1QYXltZW50RGF0YTtcbiAgICByZWRpcmVjdD86ICdhbHdheXMnO1xuICB9KTogT2JzZXJ2YWJsZTxuZXZlciB8IHsgZXJyb3I6IFN0cmlwZUVycm9yIH0+O1xuICBjb25maXJtU2V0dXAob3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtU2V0dXAob3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtQWNzc0RlYml0U2V0dXAoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1BY3NzRGViaXRTZXR1cERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1BY3NzRGViaXRTZXR1cE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1BY3NzRGViaXRTZXR1cChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybVVzQmFua0FjY291bnRTZXR1cChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybVVzQmFua0FjY291bnRTZXR1cERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1Vc0JhbmtBY2NvdW50U2V0dXAoY2xpZW50U2VjcmV0LCBkYXRhKTtcbiAgfVxuXG4gIGNvbmZpcm1BdUJlY3NEZWJpdFNldHVwKFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtQXVCZWNzRGViaXRTZXR1cERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1BdUJlY3NEZWJpdFNldHVwKGNsaWVudFNlY3JldCwgZGF0YSk7XG4gIH1cblxuICBjb25maXJtQmFjc0RlYml0U2V0dXAoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1CYWNzRGViaXRTZXR1cERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1CYWNzRGViaXRTZXR1cChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybUJhbmNvbnRhY3RTZXR1cChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUJhbmNvbnRhY3RTZXR1cERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1CYW5jb250YWN0U2V0dXAoY2xpZW50U2VjcmV0LCBkYXRhKTtcbiAgfVxuXG4gIGNvbmZpcm1DYXJkU2V0dXAoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1DYXJkU2V0dXBEYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtQ2FyZFNldHVwT3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUNhcmRTZXR1cChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUlkZWFsU2V0dXAoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1JZGVhbFNldHVwRGF0YVxuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUlkZWFsU2V0dXAoY2xpZW50U2VjcmV0LCBkYXRhKTtcbiAgfVxuXG4gIGNvbmZpcm1QYXlQYWxTZXR1cChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybVBheVBhbFNldHVwRGF0YVxuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybVBheVBhbFNldHVwKGNsaWVudFNlY3JldCwgZGF0YSk7XG4gIH1cblxuICBjb25maXJtU2VwYURlYml0U2V0dXAoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1TZXBhRGViaXRTZXR1cERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1TZXBhRGViaXRTZXR1cChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybVNvZm9ydFNldHVwKFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtU29mb3J0U2V0dXBEYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtU29mb3J0U2V0dXBPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtU29mb3J0U2V0dXAoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1BZmZpcm1QYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtQWZmaXJtUGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1BZmZpcm1QYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1BZmZpcm1QYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtQWZ0ZXJwYXlDbGVhcnBheVBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1BZnRlcnBheUNsZWFycGF5UGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1BZnRlcnBheUNsZWFycGF5UGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtQWZ0ZXJwYXlDbGVhcnBheVBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIHZlcmlmeU1pY3JvZGVwb3NpdHNGb3JTZXR1cChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogVmVyaWZ5TWljcm9kZXBvc2l0c0ZvclNldHVwRGF0YVxuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUudmVyaWZ5TWljcm9kZXBvc2l0c0ZvclNldHVwKGNsaWVudFNlY3JldCwgZGF0YSk7XG4gIH1cblxuICBjb2xsZWN0QmFua0FjY291bnRGb3JTZXR1cChvcHRpb25zPzogQ29sbGVjdEJhbmtBY2NvdW50Rm9yU2V0dXBPcHRpb25zKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbGxlY3RCYW5rQWNjb3VudEZvclNldHVwKG9wdGlvbnMpO1xuICB9XG5cbiAgcmV0cmlldmVTZXR1cEludGVudChjbGllbnRTZWNyZXQ6IHN0cmluZyk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5yZXRyaWV2ZVNldHVwSW50ZW50KGNsaWVudFNlY3JldCk7XG4gIH1cblxuICBwYXltZW50UmVxdWVzdChvcHRpb25zOiBQYXltZW50UmVxdWVzdE9wdGlvbnMpOiBQYXltZW50UmVxdWVzdCB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLnBheW1lbnRSZXF1ZXN0KG9wdGlvbnMpO1xuICB9XG5cbiAgY3JlYXRlVG9rZW4oXG4gICAgdG9rZW5UeXBlOiBTdHJpcGVJYmFuRWxlbWVudCxcbiAgICBkYXRhOiBDcmVhdGVUb2tlbkliYW5EYXRhXG4gICk6IE9ic2VydmFibGU8eyB0b2tlbj86IFRva2VuOyBlcnJvcj86IFN0cmlwZUVycm9yIH0+O1xuICBjcmVhdGVUb2tlbihcbiAgICB0b2tlblR5cGU6IFN0cmlwZUNhcmRFbGVtZW50IHwgU3RyaXBlQ2FyZE51bWJlckVsZW1lbnQsXG4gICAgZGF0YT86IENyZWF0ZVRva2VuQ2FyZERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7IHRva2VuPzogVG9rZW47IGVycm9yPzogU3RyaXBlRXJyb3IgfT47XG4gIGNyZWF0ZVRva2VuKHRva2VuVHlwZTogJ3BpaScsIGRhdGE6IENyZWF0ZVRva2VuUGlpRGF0YSk6IE9ic2VydmFibGU8eyB0b2tlbj86IFRva2VuOyBlcnJvcj86IFN0cmlwZUVycm9yIH0+O1xuICBjcmVhdGVUb2tlbihcbiAgICB0b2tlblR5cGU6ICdiYW5rX2FjY291bnQnLFxuICAgIGRhdGE6IENyZWF0ZVRva2VuQmFua0FjY291bnREYXRhXG4gICk6IE9ic2VydmFibGU8eyB0b2tlbj86IFRva2VuOyBlcnJvcj86IFN0cmlwZUVycm9yIH0+O1xuICBjcmVhdGVUb2tlbihcbiAgICB0b2tlblR5cGU6ICdjdmNfdXBkYXRlJyxcbiAgICBlbGVtZW50PzogU3RyaXBlQ2FyZEN2Y0VsZW1lbnRcbiAgKTogT2JzZXJ2YWJsZTx7IHRva2VuPzogVG9rZW47IGVycm9yPzogU3RyaXBlRXJyb3IgfT47XG4gIGNyZWF0ZVRva2VuKFxuICAgIHRva2VuVHlwZTogJ2FjY291bnQnLFxuICAgIGRhdGE6IFRva2VuQ3JlYXRlUGFyYW1zLkFjY291bnRcbiAgKTogT2JzZXJ2YWJsZTx7IHRva2VuPzogVG9rZW47IGVycm9yPzogU3RyaXBlRXJyb3IgfT47XG4gIGNyZWF0ZVRva2VuKHRva2VuVHlwZTogJ3BlcnNvbicsIGRhdGE6IFRva2VuQ3JlYXRlUGFyYW1zLlBlcnNvbik6IE9ic2VydmFibGU8eyB0b2tlbj86IFRva2VuOyBlcnJvcj86IFN0cmlwZUVycm9yIH0+O1xuICBjcmVhdGVUb2tlbih0b2tlblR5cGUsIGRhdGEpIHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY3JlYXRlVG9rZW4odG9rZW5UeXBlLCBkYXRhKTtcbiAgfVxuXG4gIGNyZWF0ZVNvdXJjZShcbiAgICBlbGVtZW50OiBTdHJpcGVFbGVtZW50LFxuICAgIHNvdXJjZURhdGE6IENyZWF0ZVNvdXJjZURhdGFcbiAgKTogT2JzZXJ2YWJsZTx7IHNvdXJjZT86IFNvdXJjZTsgZXJyb3I/OiBTdHJpcGVFcnJvciB9PjtcbiAgY3JlYXRlU291cmNlKHNvdXJjZURhdGE6IENyZWF0ZVNvdXJjZURhdGEpOiBPYnNlcnZhYmxlPHsgc291cmNlPzogU291cmNlOyBlcnJvcj86IFN0cmlwZUVycm9yIH0+O1xuICBjcmVhdGVTb3VyY2UoYSwgYj8pOiBPYnNlcnZhYmxlPHsgc291cmNlPzogU291cmNlOyBlcnJvcj86IFN0cmlwZUVycm9yIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY3JlYXRlU291cmNlKGEsIGIpO1xuICB9XG5cbiAgcmV0cmlldmVTb3VyY2Uoc291cmNlOiBSZXRyaWV2ZVNvdXJjZVBhcmFtKTogT2JzZXJ2YWJsZTx7IHNvdXJjZT86IFNvdXJjZTsgZXJyb3I/OiBTdHJpcGVFcnJvciB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLnJldHJpZXZlU291cmNlKHNvdXJjZSk7XG4gIH1cblxuICB2ZXJpZnlJZGVudGl0eShjbGllbnRTZWNyZXQ6IHN0cmluZyk6IE9ic2VydmFibGU8VmVyaWZpY2F0aW9uU2Vzc2lvblJlc3VsdD4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS52ZXJpZnlJZGVudGl0eShjbGllbnRTZWNyZXQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkXG4gICAqL1xuICBoYW5kbGVDYXJkUGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBlbGVtZW50PyxcbiAgICBkYXRhP1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmhhbmRsZUNhcmRQYXltZW50KGNsaWVudFNlY3JldCwgZWxlbWVudCwgZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICovXG4gIGNvbmZpcm1QYXltZW50SW50ZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGVsZW1lbnQ/LFxuICAgIGRhdGE/XG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybVBheW1lbnRJbnRlbnQoY2xpZW50U2VjcmV0LCBlbGVtZW50LCBkYXRhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKi9cbiAgaGFuZGxlQ2FyZFNldHVwKFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGVsZW1lbnQ/LFxuICAgIGRhdGE/XG4gICk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5oYW5kbGVDYXJkU2V0dXAoY2xpZW50U2VjcmV0LCBlbGVtZW50LCBkYXRhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKi9cbiAgY29uZmlybVNldHVwSW50ZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGVsZW1lbnQ/LFxuICAgIGRhdGE/XG4gICk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtU2V0dXBJbnRlbnQoY2xpZW50U2VjcmV0LCBlbGVtZW50LCBkYXRhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKi9cbiAgaGFuZGxlRnB4UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBlbGVtZW50PyxcbiAgICBkYXRhP1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuaGFuZGxlRnB4UGF5bWVudChjbGllbnRTZWNyZXQsIGVsZW1lbnQsIGRhdGEpO1xuICB9XG59XG4iXX0=